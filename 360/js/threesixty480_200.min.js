$(document).ready(function(){function e(){_=new CanvasLoader("spinner"),_.setShape("spiral"),_.setDiameter(90),_.setDensity(90),_.setRange(1),_.setSpeed(4),_.setColor("#FFFFFF"),_.show(),$("#spinner").fadeIn("slow")}function t(){var e=document.createElement("li"),t="area51/480_200_1920/b_"+(U+1)+".jpg",o=$("<img>").attr("src",t).addClass("previous-image").appendTo(e);B.push(o),$("#threesixty_images").append(e),$(o).load(function(){n()})}function n(){U++,$("#spinner span").text(Math.floor(U/j*100)+"%"),U==j?(B[0].removeClass("previous-image").addClass("current-image"),$("#spinner").fadeOut("slow",function(){$("#breathelight").fadeIn("slow",function(){_.hide(),d("standby"),i()})})):t()}function o(){window.clearTimeout(M),k=!1,C=!0,G=y(),u(),$("#threesixty_progress").fadeOut(),$(".progressbar").fadeOut(),$("#return").hide()}function i(){$("#threesixty_images").fadeIn("slow"),b=!0,C=!1,G=201,m("standby"),d("audio"),u()}function r(){if(L!==G){window.clearTimeout(D),window.clearTimeout(M),D=0,F=0,1==K&&v();var e=L>G?Math.floor(.1*(G-L)):Math.ceil(.1*(G-L));a(),L+=e,l()}else{window.clearInterval(A),M=setTimeout(o,q),A=0;var t=g();m("story"),C&&(b=!1),0==b?(window.clearTimeout(M),M=0,$("#threesixty_images").fadeOut("slow",function(){$("#breathelight").fadeIn("slow",function(){$("#breathelight").append('<li class="bluelight"><img src="area51/breathelight.png"/></li>'),d("standby")})}),$("#threesixty_progress").removeAttr("style")):($("#threesixty_progress").animate({bottom:"2%",opacity:1},1500),$("#return").fadeIn(),d("bgm")),t>1&&8>t&&2!=t?(x=h(2),0===D&&(D=self.setInterval(s,J))):t>1&&4>t?F=setTimeout(p("cover"),1e3):t>9&&20>t&&14!=t?(x=h(14),0===D&&(D=self.setInterval(s,J))):t>11&&18>t?F=setTimeout(p("front"),1e3):t>30&&42>t&&36!=t?(x=h(36),0===D&&(D=self.setInterval(s,J))):t>33&&39>t?F=setTimeout(p("io"),1e3):t>67&&79>t&&73!=t?(x=h(73),0===D&&(D=self.setInterval(s,J))):t>70&&76>t?F=setTimeout(p("cpu"),1e3):t>120&&132>t&&126!=t?(x=h(126),0===D&&(D=self.setInterval(s,J))):t>123&&129>t?F=setTimeout(p("gpu"),1e3):t>161&&173>t&&167!=t?(x=h(167),0===D&&(D=self.setInterval(s,J))):t>163&&170>t?F=setTimeout(p("power"),1e3):t>174&&184>t&&178!=t?(x=h(178),0===D&&(D=self.setInterval(s,J))):t>175&&181>t&&(F=setTimeout(p("disk"),1e3))}}function s(){if(G=x,L!==G){window.clearInterval(A),window.clearTimeout(M),A=0,b=!1,F=0,1==K&&v();var e=L>G?Math.floor(.1*(G-L)):Math.ceil(.1*(G-L));a(),L+=e,l()}else{window.clearTimeout(D),M=setTimeout(o,q),D=0,b=!0,m("story");var t=g();0==b&&(window.clearTimeout(M),$("#threesixty_images").fadeOut("slow",function(){$("#breathelight").fadeIn("slow",function(){$("#breathelight").append('<li class="bluelight"><img src="area51/breathelight.png"/></li>'),d("standby")})}),$("#threesixty_progress").removeAttr("style")),t>1&&4>t?F=setTimeout(p("cover"),1e3):t>11&&18>t?F=setTimeout(p("front"),1e3):t>33&&39>t?F=setTimeout(p("io"),1e3):t>70&&76>t?F=setTimeout(p("cpu"),1e3):t>123&&129>t?F=setTimeout(p("gpu"),1e3):t>163&&170>t?F=setTimeout(p("power"),1e3):t>175&&181>t&&(F=setTimeout(p("disk"),1e3))}}function u(){0===A&&1==b&&(A=self.setInterval(r,Q))}function a(){B[c()].removeClass("current-image").addClass("previous-image")}function l(){B[c()].removeClass("previous-image").addClass("current-image"),$("#threesixty_progress li").width(100-c()/2+"%")}function c(){var e=-Math.ceil(L%j);return 0>e&&(e+=j-1),e}function f(e){return e.originalEvent.targetTouches?e.originalEvent.targetTouches[0]:e}function d(e){return}function m(e){return}function p(e){1!=$("#story_"+e).hasClass("bounce")&&"off"==I&&(K=!0,$("#treesixty_detail>li>div").stop(!0).hide(),$("#threesixty_progress").find("."+e).addClass("bounce"),$("#detail_"+e).find(".light").fadeIn("slow"),$("#detail_"+e).find(".mark").show().animate({left:"0%",opacity:1},500,function(){$("#detail_"+e).find(".title").show().animate({top:"0%",opacity:1},300),$("#detail_"+e).find(".content").show().animate({top:"0%",opacity:1},300)}))}function v(){I="on",$("#threesixty_progress span").removeClass("bounce"),$("#treesixty_detail li div").hide(function(){$(this).removeAttr("style"),I="off",K=!1})}function h(e){P=e;var t=g();if(t>e)var n=L-(t-e);else var n=L+(e-t);return n}function y(){var e=g(),t=L-e-j+1;return t}function g(){return Math.abs(Math.ceil(L%j))}function w(e){b&&k&&(O=f(e).pageX,S<(new Date).getTime()-X&&(E=O-R,G=L+Math.ceil((j-1)*z*(E/$("#threesixty").width())),u(),S=(new Date).getTime(),R=f(e).pageX))}function T(e){e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}var _,b=!1,D=0,x=0,I="off",F=0,C=!0,M=0,q=9e5,k=!1,R=0,O=0,E=0,S=0,X=10,A=0,z=3,j=200,L=0,B=[],G=0,H=40,J=100,K=!1,N=1,P=0,Q=H,U=0;T(document.documentElement),e(),t(),$("#threesixty").mousedown(function(e){e.preventDefault(),R=f(e).pageX,N=g(),k=!0}),$(document).mouseup(function(e){e.preventDefault(),k=!1,window.clearTimeout(M),M=setTimeout(o,q)}),$(document).mousemove(function(e){e.preventDefault(),Q=H,w(e),window.clearTimeout(M),M=setTimeout(o,q)}),$(document).live("touchend",function(){window.clearTimeout(M),M=setTimeout(o,q)}),$("#threesixty").live("touchstart",function(e){e.preventDefault(),R=f(e).pageX,N=g(),k=!0}),$("#threesixty").live("touchmove",function(e){e.preventDefault(),Q=H,w(e),window.clearTimeout(M),M=setTimeout(o,q)}),$("#threesixty").live("touchend",function(e){e.preventDefault(),k=!1,window.clearTimeout(M),M=setTimeout(o,q)}),$("#story_cpu").mouseup(function(e){"on"!=I&&(v(),e.preventDefault(),k=!1,G=h(73),Q=J,u(),d("story"))}),$("#story_cpu").live("touchend",function(){"on"!=I&&(v(),event.preventDefault(),k=!1,G=h(73),Q=J,u(),d("story"))}),$("#story_cover").mouseup(function(e){"on"!=I&&(v(),e.preventDefault(),k=!1,G=h(2),Q=J,u(),d("story"))}),$("#story_cover").live("touchend",function(){"on"!=I&&(v(),event.preventDefault(),k=!1,G=h(2),Q=J,u(),d("story"))}),$("#story_front").mouseup(function(e){"on"!=I&&(v(),e.preventDefault(),k=!1,G=h(14),Q=J,u(),d("story"))}),$("#story_front").live("touchend",function(){"on"!=I&&(v(),event.preventDefault(),k=!1,G=h(14),Q=J,u(),d("story"))}),$("#story_io").mouseup(function(e){"on"!=I&&(v(),e.preventDefault(),k=!1,G=h(36),Q=J,u(),d("story"))}),$("#story_io").live("touchend",function(){"on"!=I&&(v(),event.preventDefault(),k=!1,G=h(36),Q=J,u(),d("story"))}),$("#story_gpu").mouseup(function(e){"on"!=I&&(v(),e.preventDefault(),k=!1,G=h(126),Q=J,u(),d("story"))}),$("#story_gpu").live("touchend",function(){"on"!=I&&(v(),event.preventDefault(),k=!1,G=h(126),Q=J,u(),d("story"))}),$("#story_power").mouseup(function(e){"on"!=I&&(v(),e.preventDefault(),k=!1,G=h(167),Q=J,u(),d("story"))}),$("#story_power").live("touchend",function(){"on"!=I&&(v(),event.preventDefault(),k=!1,G=h(167),Q=J,u(),d("story"))}),$("#story_disk").mouseup(function(e){"on"!=I&&(v(),e.preventDefault(),k=!1,G=h(178),Q=J,u(),d("story"))}),$("#story_disk").live("touchend",function(){"on"!=I&&(v(),event.preventDefault(),k=!1,G=h(178),Q=J,u(),d("story"))}),$("#finger_touch").on("touchend mouseup",function(){$("#breathelight").hide(),$("#threesixty_images").show(function(){i()})}),$("#return").on("mouseup touchend",function(){o(),m("bgm"),d("standby")})});